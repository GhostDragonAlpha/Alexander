# Asteroid Field System - Visual Architecture Diagrams

**For:** Visual understanding of system architecture
**See Also:**
- ASTEROID_FIELD_SYSTEM_DESIGN.md (full details)
- ASTEROID_FIELD_QUICK_REFERENCE.md (implementation guide)

---

## System Overview Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                   GAME WORLD                                     â”‚
â”‚                                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                         AAsteroidFieldManager                            â”‚   â”‚
â”‚  â”‚                         (Master Coordinator)                             â”‚   â”‚
â”‚  â”‚                                                                          â”‚   â”‚
â”‚  â”‚  Properties:                      Functions:                            â”‚   â”‚
â”‚  â”‚  â€¢ TargetAsteroidCount: 1000      â€¢ InitializeField()                   â”‚   â”‚
â”‚  â”‚  â€¢ FieldRadius: 100 km            â€¢ UpdateAsteroidTiers()               â”‚   â”‚
â”‚  â”‚  â€¢ Tier0Radius: 1 km              â€¢ SpawnAsteroids()                    â”‚   â”‚
â”‚  â”‚  â€¢ Tier1Radius: 50 km             â€¢ ReplicateActiveAsteroids()          â”‚   â”‚
â”‚  â”‚  â€¢ RandomSeed: 12345              â€¢ AdjustQualitySettings()             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚           â”‚                     â”‚              â”‚            â”‚                   â”‚
â”‚           â†“                     â†“              â†“            â†“                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚USpatialHashGridâ”‚   â”‚UAsteroidPool    â”‚  â”‚UAsteroid-â”‚  â”‚UAsteroidVFXMgr  â”‚  â”‚
â”‚  â”‚                â”‚   â”‚                 â”‚  â”‚TierMgr   â”‚  â”‚                 â”‚  â”‚
â”‚  â”‚Grid: 20Ã—20Ã—20  â”‚   â”‚Size: 2000       â”‚  â”‚          â”‚  â”‚Instances: 10k   â”‚  â”‚
â”‚  â”‚Cell: 5km       â”‚   â”‚Available: 1500  â”‚  â”‚Updates   â”‚  â”‚GPU Rendering    â”‚  â”‚
â”‚  â”‚                â”‚   â”‚Active: 500      â”‚  â”‚Distance  â”‚  â”‚                 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚           â”‚                    â”‚                 â”‚                 â”‚            â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                       â†“                                          â”‚
â”‚                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚                          â”‚   AAsteroid : AOrbitalBody  â”‚                        â”‚
â”‚                          â”‚                             â”‚                        â”‚
â”‚                          â”‚  CurrentTier: EAsteroidTier â”‚                        â”‚
â”‚                          â”‚  Mass: float                â”‚                        â”‚
â”‚                          â”‚  Radius: float              â”‚                        â”‚
â”‚                          â”‚  Velocity: FVector          â”‚                        â”‚
â”‚                          â”‚                             â”‚                        â”‚
â”‚                          â”‚  UpdateTier0_Critical()     â”‚                        â”‚
â”‚                          â”‚  UpdateTier1_Active()       â”‚                        â”‚
â”‚                          â”‚  UpdateTier2_Distant()      â”‚                        â”‚
â”‚                          â”‚  FragmentAsteroid()         â”‚                        â”‚
â”‚                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚                                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Tier System Flow Diagram

```
                             PLAYER SHIP POSITION
                                     â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚     Calculate Distance to All Asteroids            â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚          Assign to Appropriate Tier                â”‚
        â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚        â”‚        â”‚        â”‚        â”‚
            â†“        â†“        â†“        â†“        â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  TIER 0   â”‚â”‚  TIER 1  â”‚â”‚ TIER 2  â”‚â”‚ TIER 3 â”‚â”‚  TIER 4    â”‚
    â”‚ Critical  â”‚â”‚  Active  â”‚â”‚ Distant â”‚â”‚  Far   â”‚â”‚ Procedural â”‚
    â”‚           â”‚â”‚          â”‚â”‚         â”‚â”‚        â”‚â”‚            â”‚
    â”‚ 0-1 km    â”‚â”‚ 1-50 km  â”‚â”‚ 50-200kmâ”‚â”‚200-500â”‚â”‚ 500+ km    â”‚
    â”‚ ~20 obj   â”‚â”‚ ~200 obj â”‚â”‚ ~400 objâ”‚â”‚~500 objâ”‚â”‚ ~10k obj   â”‚
    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
          â”‚           â”‚           â”‚         â”‚            â”‚
          â†“           â†“           â†“         â†“            â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Full N-body â”‚ Simplified â”‚ Kinematic â”‚ LOD Only â”‚ GPU   â”‚
    â”‚ Physics     â”‚ Physics    â”‚ Orbits    â”‚          â”‚Instanceâ”‚
    â”‚             â”‚            â”‚           â”‚          â”‚        â”‚
    â”‚ F=Gmâ‚mâ‚‚/rÂ² â”‚ F from     â”‚ Pos+=V*dt â”‚ No       â”‚ Single â”‚
    â”‚ All pairs  â”‚ Tier 0 onlyâ”‚ No forces â”‚ physics  â”‚ draw   â”‚
    â”‚             â”‚            â”‚           â”‚          â”‚ call   â”‚
    â”‚ 0.8ms      â”‚ 0.8ms      â”‚ 0.4ms     â”‚ 0.1ms    â”‚ 0.2ms  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Spatial Hash Grid Visualization

```
                  TOP-DOWN VIEW OF SPACE
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    â”‚    â”‚    â”‚    â”‚    â”‚    â”‚    â”‚    â”‚    â”‚    â”‚    â”‚
    â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤
    â”‚    â”‚    â”‚    â”‚  * â”‚    â”‚    â”‚    â”‚  * â”‚    â”‚    â”‚  * = Asteroid
    â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤
    â”‚    â”‚  * â”‚    â”‚    â”‚    â”‚    â”‚    â”‚    â”‚    â”‚    â”‚
    â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤  Each cell: 5km Ã— 5km
    â”‚    â”‚    â”‚    â”‚    â”‚    â”‚  â—‰ â”‚  * â”‚    â”‚    â”‚    â”‚
    â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤  â—‰ = Ship
    â”‚    â”‚    â”‚    â”‚    â”‚    â”‚ â†‘* â”‚    â”‚    â”‚  * â”‚    â”‚
    â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤      â†‘
    â”‚    â”‚    â”‚  * â”‚    â”‚    â”‚ â†â”€â”¼â”€â†’  â”‚    â”‚    â”‚    â”‚  Ship checks
    â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤  these cells
    â”‚    â”‚    â”‚    â”‚  * â”‚    â”‚  â†“ â”‚    â”‚    â”‚    â”‚    â”‚      â†“
    â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤
    â”‚    â”‚    â”‚    â”‚    â”‚    â”‚  * â”‚    â”‚    â”‚    â”‚  * â”‚
    â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤
    â”‚    â”‚    â”‚    â”‚    â”‚    â”‚    â”‚    â”‚    â”‚    â”‚    â”‚
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Without Spatial Grid:
    Ship checks ALL asteroids: 1000 checks per frame

With Spatial Grid:
    Ship checks only 3Ã—3Ã—3 = 27 adjacent cells
    Average 0.125 asteroids per cell
    Total: 27 Ã— 0.125 = ~3.4 checks per frame

    Speedup: 1000 / 3.4 = 294x faster! âœ“
```

---

## Performance Budget Pie Chart

```
        FRAME BUDGET (16.67ms @ 60 FPS)
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘                                      â•‘
    â•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  Rendering   6.00ms   â•‘  36%
    â•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ      Physics     4.00ms   â•‘  24%
    â•‘   â–ˆâ–ˆâ–ˆâ–ˆ          Gameplay    2.00ms   â•‘  12%
    â•‘   â–ˆâ–ˆâ–ˆ           Asteroids   2.67ms   â•‘  16%  â† Our System
    â•‘   â–ˆâ–ˆ            Animation   1.50ms   â•‘   9%
    â•‘   â–ˆ             Network     1.00ms   â•‘   6%
    â•‘   â–ˆ             Audio       1.00ms   â•‘   6%
    â•‘                                      â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    Asteroid System Breakdown (2.67ms):
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Tier 0 (Critical)       0.80ms     â”‚  30%
    â”‚ Tier 1 (Active)         0.80ms     â”‚  30%
    â”‚ Tier 2 (Distant)        0.40ms     â”‚  15%
    â”‚ Tier 3 (Far)            0.10ms     â”‚   4%
    â”‚ Tier 4 (Procedural)     0.20ms     â”‚   7%
    â”‚ Spatial Grid            0.20ms     â”‚   7%
    â”‚ Tier Management         0.17ms     â”‚   6%
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Network Replication Flow

```
                          SERVER
                            â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                       â”‚                       â”‚
    â”‚  1. Generate Field    â”‚                       â”‚
    â”‚     with Seed 12345   â”‚                       â”‚
    â”‚                       â”‚                       â”‚
    â”‚  Asteroid 0:          â”‚                       â”‚
    â”‚   Pos: (100, 200, 50) â”‚                       â”‚
    â”‚   Mass: 5000 kg       â”‚                       â”‚
    â”‚   Vel: (10, 0, 5)     â”‚   2. Replicate Seed   â”‚
    â”‚                       â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚
    â”‚  Asteroid 1:          â”‚                       â”‚
    â”‚   Pos: (300, 150, 75) â”‚   FAsteroidFieldState â”‚
    â”‚   Mass: 8000 kg       â”‚   {                   â”‚
    â”‚   Vel: (5, 10, 0)     â”‚     Seed: 12345       â”‚
    â”‚                       â”‚     Center: (0,0,0)   â”‚
    â”‚  ... Ã— 1000 asteroids â”‚     Radius: 100km     â”‚
    â”‚                       â”‚   }                   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚
                            â”‚  3. Clients Generate
                            â”‚     SAME Field
                            â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚              CLIENT 1          CLIENT 2       â”‚
    â”‚                                               â”‚
    â”‚  Generate with Seed 12345                    â”‚
    â”‚                                               â”‚
    â”‚  Asteroid 0:           Asteroid 0:           â”‚
    â”‚   Pos: (100, 200, 50)   Pos: (100, 200, 50) â”‚  â† IDENTICAL!
    â”‚   Mass: 5000 kg         Mass: 5000 kg       â”‚
    â”‚                                               â”‚
    â”‚  Asteroid 1:           Asteroid 1:           â”‚
    â”‚   Pos: (300, 150, 75)   Pos: (300, 150, 75) â”‚  â† IDENTICAL!
    â”‚   Mass: 8000 kg         Mass: 8000 kg       â”‚
    â”‚                                               â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    Bandwidth Savings:
    â€¢ Without determinism: 1000 asteroids Ã— 22 bytes/update Ã— 2 Hz = 44 KB/s
    â€¢ With determinism:    0 bytes/s for kinematic asteroids
    â€¢ Only replicate ~50 active asteroids: 2.2 KB/s
    â€¢ TOTAL SAVINGS: 95% bandwidth reduction! âœ“
```

---

## Collision Detection Flow

```
    NAIVE APPROACH (O(NÂ²)):
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    For each asteroid A:
        For each asteroid B:
            If A and B collide:
                Handle collision

    1000 asteroids = 1000Ã—999/2 = 499,500 checks
    Time: ~50ms (TOO SLOW! âœ—)


    SPATIAL GRID APPROACH (O(N)):
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    1. Build Grid:
       For each asteroid:
           cell = WorldToGridCoord(asteroid.position)
           grid[cell].Add(asteroid)

    2. Check Collisions:
       For each asteroid A:
           cell = WorldToGridCoord(A.position)
           For each adjacent cell (27 cells):
               For each asteroid B in cell:
                   If A and B collide:
                       Handle collision

    1000 asteroids Ã— 10 avg checks = 10,000 checks
    Time: ~0.5ms (FAST! âœ“)

    Speedup: 100x faster!
```

---

## Object Pool Lifecycle

```
    INITIALIZATION:
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  UAsteroidPool::PreallocatePool()   â”‚
    â”‚                                     â”‚
    â”‚  for (i = 0; i < 1000; i++)         â”‚
    â”‚      AvailableAsteroids.Add(        â”‚
    â”‚          SpawnActor<AAsteroid>()    â”‚
    â”‚      )                               â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  POOL STATE                                   â”‚
    â”‚                                               â”‚
    â”‚  AvailableAsteroids: [Aâ‚€, Aâ‚, Aâ‚‚, ... Aâ‚‰â‚‰â‚‰]  â”‚
    â”‚  ActiveAsteroids: []                          â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


    ACQUIRE ASTEROID:
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    AsteroidFieldManager needs new asteroid
                    â†“
    Pool->AcquireAsteroid(Location, Rotation)
                    â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  1. Pop from AvailableAsteroids     â”‚
    â”‚  2. Configure position/rotation     â”‚
    â”‚  3. SetActorHiddenInGame(false)     â”‚
    â”‚  4. Add to ActiveAsteroids          â”‚
    â”‚  5. Return asteroid pointer         â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  POOL STATE                                   â”‚
    â”‚                                               â”‚
    â”‚  AvailableAsteroids: [Aâ‚, Aâ‚‚, ... Aâ‚‰â‚‰â‚‰]      â”‚
    â”‚  ActiveAsteroids: [Aâ‚€]                        â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


    RELEASE ASTEROID:
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    Asteroid destroyed or far from player
                    â†“
    Pool->ReleaseAsteroid(Asteroid)
                    â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  1. Remove from ActiveAsteroids     â”‚
    â”‚  2. SetActorHiddenInGame(true)      â”‚
    â”‚  3. Reset physics state             â”‚
    â”‚  4. Add to AvailableAsteroids       â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  POOL STATE                                   â”‚
    â”‚                                               â”‚
    â”‚  AvailableAsteroids: [Aâ‚€, Aâ‚, Aâ‚‚, ... Aâ‚‰â‚‰â‚‰]  â”‚
    â”‚  ActiveAsteroids: []                          â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


    Performance:
    â€¢ Spawn/Destroy: ~1ms per asteroid (triggers GC)
    â€¢ Acquire/Release: ~0.001ms per asteroid (100x faster!)
    â€¢ No GC spikes! âœ“
```

---

## Tier Transition State Machine

```
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                                            â”‚
    â”‚  TIER 4 (Procedural)                                       â”‚
    â”‚  Distance > 500 km                                         â”‚
    â”‚  â€¢ GPU Instanced                                           â”‚
    â”‚  â€¢ No physics                                              â”‚
    â”‚  â€¢ Single draw call                                        â”‚
    â”‚                                                            â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚ Distance < 450 km           â”‚ Distance > 550 km
                   â†“ (with hysteresis)           â†‘
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                                            â”‚
    â”‚  TIER 3 (Far)                                              â”‚
    â”‚  Distance: 200-500 km                                      â”‚
    â”‚  â€¢ Individual mesh, LOD3                                   â”‚
    â”‚  â€¢ No physics                                              â”‚
    â”‚  â€¢ Culling only                                            â”‚
    â”‚                                                            â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚ Distance < 180 km           â”‚ Distance > 220 km
                   â†“                             â†‘
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                                            â”‚
    â”‚  TIER 2 (Distant)                                          â”‚
    â”‚  Distance: 50-200 km                                       â”‚
    â”‚  â€¢ Kinematic motion                                        â”‚
    â”‚  â€¢ Pre-calculated orbit path                               â”‚
    â”‚  â€¢ Position = Path[index]                                  â”‚
    â”‚                                                            â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚ Distance < 45 km            â”‚ Distance > 55 km
                   â†“                             â†‘
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                                            â”‚
    â”‚  TIER 1 (Active)                                           â”‚
    â”‚  Distance: 1-50 km                                         â”‚
    â”‚  â€¢ Simplified physics                                      â”‚
    â”‚  â€¢ Gravity from Tier 0 only                                â”‚
    â”‚  â€¢ Spatial hash collisions                                 â”‚
    â”‚  â€¢ Can collide with ships                                  â”‚
    â”‚                                                            â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚ Distance < 0.9 km           â”‚ Distance > 1.1 km
                   â†“ (ALWAYS upgrade)            â†‘
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                                            â”‚
    â”‚  TIER 0 (Critical)                                         â”‚
    â”‚  Distance: 0-1 km                                          â”‚
    â”‚  â€¢ Full N-body physics                                     â”‚
    â”‚  â€¢ F = G*mâ‚*mâ‚‚/rÂ² all pairs                                â”‚
    â”‚  â€¢ Full rigid body collisions                              â”‚
    â”‚  â€¢ Highest priority network replication                    â”‚
    â”‚                                                            â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    Hysteresis:
    â€¢ Upgrade threshold: 0.9x (90% of distance)
    â€¢ Downgrade threshold: 1.1x (110% of distance)
    â€¢ Prevents rapid oscillation between tiers
```

---

## Fragmentation Cascade

```
    LARGE ASTEROID HIT BY SHIP:
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

         â—â”€â”€â”€â”€â”€â”€â”€â—
        /         \
       â”‚   1000kg  â”‚  â†â”€â”€â”€ â—„â”€â”€â”€â”€  Ship (500 kg, 100 m/s)
        \    Radius: 5m    /      Impact energy: 2.5 MJ
         â—â”€â”€â”€â”€â”€â”€â”€â—
              â”‚
              â”‚ Fragment!
              â†“

       â—â”€â—   â—â”€â”€â—   â—â”€â—
      /   \ /    \ /   \
     â”‚200kgâ”‚250kgâ”‚200kgâ”‚  â† 3 fragments
      \   / \    / \   /     Each: Mass/3, RadiusÃ—0.69
       â—â”€â—   â—â”€â”€â—   â—â”€â—
         â†“     â†“     â†“
      Velocity += Random(20-100 m/s)


    FRAGMENT HIT AGAIN:
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

       â—â”€â”€â—
      /    \
     â”‚200kg â”‚  â†â”€â”€â”€ â—„â”€â”€â”€â”€  Another ship
      \    /       Impact energy: 1 MJ
       â—â”€â”€â—
         â”‚
         â”‚ Fragment again!
         â†“

      â—  â—  â—
     â”‚66kgâ”‚66kgâ”‚66kgâ”‚  â† 3 more fragments
      â—  â—  â—          Each: Mass/3, RadiusÃ—0.55


    TOO SMALL TO FRAGMENT:
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

      â—
     â”‚30kgâ”‚  â†â”€â”€â”€ â—„â”€â”€â”€â”€  Ship
      â—          Below MinFragmentMass (50kg)
      â”‚
      â”‚ Destroy (return to pool)
      â†“
    ğŸ’¥ VFX + SFX


    FRAGMENT LIMITS:
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    â€¢ MinFragmentMass: 50 kg (prevents infinite splitting)
    â€¢ MaxFragmentsPerFrame: 20 (prevents frame spikes)
    â€¢ MaxTotalFragments: 1000 (memory limit)
    â€¢ Auto-cleanup: Remove oldest when over limit
```

---

## GPU Instancing Architecture

```
    TRADITIONAL RENDERING (Tier 0-3):
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    For each asteroid:
        SetupDrawCall()
        SetTransform(asteroid.transform)
        SetMaterial(asteroid.material)
        DrawMesh(asteroid.mesh)

    500 asteroids = 500 draw calls
    CPU time: ~5ms (SLOW! âœ—)


    GPU INSTANCED RENDERING (Tier 4):
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    // CPU (once per frame):
    UpdateInstanceBuffer({
        Transform[0] = asteroid[0].transform,
        Transform[1] = asteroid[1].transform,
        ...
        Transform[9999] = asteroid[9999].transform
    })

    // GPU (single draw call):
    for (instanceID = 0; instanceID < 10000; instanceID++) {
        transform = InstanceBuffer[instanceID]
        vertex = transform * meshVertex
        output vertex to screen
    }

    10,000 asteroids = 1 draw call
    CPU time: ~0.2ms (FAST! âœ“)

    Speedup: 25x faster!


    INSTANCE DATA STRUCTURE:
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Instance Buffer (GPU Memory)                â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚ [0] Transform: Matrix4x4 (64 bytes)         â”‚
    â”‚     CustomData: Float4 (16 bytes)           â”‚
    â”‚       â†’ Size, ColorR, ColorG, ColorB        â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚ [1] Transform: Matrix4x4 (64 bytes)         â”‚
    â”‚     CustomData: Float4 (16 bytes)           â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚ ...                                         â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚ [9999] Transform: Matrix4x4 (64 bytes)      â”‚
    â”‚        CustomData: Float4 (16 bytes)        â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    Total: 10,000 Ã— 80 bytes = 800 KB (minimal!)
```

---

## Integration with Existing Systems

```
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                    EXISTING SYSTEMS                        â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚           â”‚           â”‚           â”‚
                    â†“           â†“           â†“           â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚UCelestialBody    â”‚  â”‚AOrbitalBodyâ”‚ â”‚UShipCustomâ”‚ â”‚PlayerOrigin â”‚
    â”‚Registry          â”‚  â”‚            â”‚ â”‚ization    â”‚ â”‚Manager      â”‚
    â”‚                  â”‚  â”‚            â”‚ â”‚System     â”‚ â”‚             â”‚
    â”‚â€¢ RegisterBody()  â”‚  â”‚â€¢ Mass      â”‚ â”‚â€¢ HullIntegâ”‚ â”‚â€¢ NotifyPos  â”‚
    â”‚â€¢ GetAllBodies()  â”‚  â”‚â€¢ Radius    â”‚ â”‚â€¢ ThrustPwrâ”‚ â”‚â€¢ Recenter() â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
             â”‚                  â”‚              â”‚              â”‚
             â”‚                  â”‚              â”‚              â”‚
             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚              NEW ASTEROID FIELD SYSTEM                     â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚                                                            â”‚
    â”‚  AAsteroidFieldManager                                     â”‚
    â”‚  â”œâ”€ Registers asteroids with CelestialBodyRegistry âœ“      â”‚
    â”‚  â””â”€ Notified by PlayerOriginManager on recenter âœ“         â”‚
    â”‚                                                            â”‚
    â”‚  AAsteroid : AOrbitalBody                                  â”‚
    â”‚  â”œâ”€ Inherits Mass, Radius, Velocity âœ“                     â”‚
    â”‚  â””â”€ Uses inherited orbital mechanics âœ“                     â”‚
    â”‚                                                            â”‚
    â”‚  Ship Collision Handler                                    â”‚
    â”‚  â”œâ”€ Reads HullIntegrity from ShipCustomizationSystem âœ“    â”‚
    â”‚  â”œâ”€ Reads ThrustPower from AOrbitalBody âœ“                 â”‚
    â”‚  â””â”€ Calculates damage based on stats âœ“                    â”‚
    â”‚                                                            â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


    INTEGRATION POINTS:
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    1. UCelestialBodyRegistry::RegisterCelestialBody(Asteroid)
       â†’ Each asteroid registers on spawn
       â†’ Shows up in GetAllCelestialBodies()

    2. AOrbitalBody base class
       â†’ AAsteroid inherits Mass, Radius, Velocity
       â†’ Reuses existing orbital mechanics

    3. UShipCustomizationSystem::CalculatePerformance()
       â†’ Returns HullIntegrity stat
       â†’ Used in collision damage formula

    4. PlayerOriginManager::OnUniverseRecenter()
       â†’ Notifies AsteroidFieldManager
       â†’ Updates all asteroid positions
```

---

## Performance Comparison Chart

```
    PERFORMANCE: Asteroid Count vs Frame Time

    Frame
    Time   â”‚
    (ms)   â”‚
           â”‚
    50ms â”€â”€â”¤     â•±â•±â•±â•±
           â”‚   â•±â•±       O(NÂ²) Without Optimization
    40ms â”€â”€â”¤ â•±â•±         (Unusable beyond 150 objects)
           â”‚â•±
    30ms â”€â”€â”¤
           â”‚
    20ms â”€â”€â”¤â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—â—â—â—â—â—â—â—â—â—â—â—â—â—â—
           â”‚            Current System
    16.67â”€â”€â”¤â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€  60 FPS Target
    (60fps)â”‚
    10ms â”€â”€â”¤
           â”‚
     5ms â”€â”€â”¤
           â”‚                     â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– 
     0ms â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’
           0   100   200   300   400   500   600   700   800   900   1000+
                                Asteroid Count

    Legend:
    â•±â•±â•± = O(NÂ²) naive approach (exponential growth)
    â—â—â— = Current system (linear up to 100, then breaks)
    â– â– â–  = NEW tiered system (stays under 3ms even at 1000+)
    â”€ â”€ = 60 FPS budget line (must stay below)


    SCALABILITY:
    â•â•â•â•â•â•â•â•â•â•â•

    Asteroids â”‚ Naive O(NÂ²) â”‚ Current â”‚ New Tiered â”‚ Improvement
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       10     â”‚    0.5 ms   â”‚  0.5 ms â”‚   0.3 ms   â”‚    1.7x
       50     â”‚    5.0 ms   â”‚  5.0 ms â”‚   0.8 ms   â”‚    6.3x
      100     â”‚   20.0 ms   â”‚ 20.0 ms â”‚   1.5 ms   â”‚   13.3x
      500     â”‚  500.0 ms   â”‚ CRASH   â”‚   2.0 ms   â”‚  250.0x
     1000     â”‚ 2000.0 ms   â”‚ CRASH   â”‚   2.3 ms   â”‚  870.0x

    At 1000 asteroids: 870x performance improvement! âœ“
```

---

## Memory Layout Diagram

```
    MEMORY USAGE (Total: 8.4 MB)

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  AAsteroid Actors (3.5 MB)                          â”‚ 42%
    â”‚  â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â–         â”‚
    â”‚  1000 active asteroids Ã— 3.5 KB each                â”‚
    â”‚    - Actor base: 2 KB                               â”‚
    â”‚    - Orbit path: 1.2 KB (100 FVectors)              â”‚
    â”‚    - Network state: 17 bytes                        â”‚
    â”‚    - Misc overhead: 300 bytes                       â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  UAsteroidPool Pre-allocation (4.0 MB)              â”‚ 48%
    â”‚  â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â–   â”‚
    â”‚  2000 pooled asteroids Ã— 2 KB each                  â”‚
    â”‚    - Dormant actors waiting for activation          â”‚
    â”‚    - Prevents GC spikes on spawn/despawn            â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  USpatialHashGrid (0.1 MB)                          â”‚  1%
    â”‚  â–                                                   â”‚
    â”‚  8000 cells Ã— ~2 pointers per cell Ã— 8 bytes        â”‚
    â”‚    - Grid: 20Ã—20Ã—20 = 8000 cells                   â”‚
    â”‚    - Each cell: TArray<AAsteroid*>                  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  GPU Instance Buffer (0.8 MB)                       â”‚  9%
    â”‚  â– â– â– â– â– â– â– â–                                           â”‚
    â”‚  10,000 instances Ã— 80 bytes each                   â”‚
    â”‚    - Transform: 64 bytes (Matrix4x4)                â”‚
    â”‚    - CustomData: 16 bytes (Float4)                  â”‚
    â”‚    - GPU memory, not CPU memory                     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    Total: 3.5 + 4.0 + 0.1 + 0.8 = 8.4 MB

    Compared to typical game assets:
    â€¢ One 4K texture: 64 MB
    â€¢ One skeletal mesh: 20 MB
    â€¢ One high-poly static mesh: 10 MB

    Our entire asteroid system: 8.4 MB (tiny!)
```

---

**All diagrams ready for implementation planning!**
